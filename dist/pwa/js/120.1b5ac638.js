"use strict";(globalThis["webpackChunkrupay_wallet"]=globalThis["webpackChunkrupay_wallet"]||[]).push([[120],{44739:(e,t,l)=>{l.r(t),l.d(t,{default:()=>pe});var a=l(61758),i=l(58790),u=l(38734),n=l(29104),o=l(60455),r=l(4855),s=l(81750);const c={__name:"Chart",props:{type:{type:String,default:"line"},data:{type:Array,required:!0},autosize:{default:!0,type:Boolean},chartOptions:{type:Object},seriesOptions:{type:Object},timeScaleOptions:{type:Object},priceScaleOptions:{type:Object}},setup(e,{expose:t}){const l=e;function i(e){return`add${e.charAt(0).toUpperCase()+e.slice(1)}Series`}let n,o;const c=(0,u.KR)(),v=()=>{o&&o.timeScale().fitContent()},d=()=>o;t({fitContent:v,getChart:d});const p=()=>{if(!o||!c.value)return;const e=c.value.getBoundingClientRect();o.resize(e.width,e.height)},m=e=>{const t=i(e.type);n=o[t](e.seriesOptions),n.setData(e.data)};return(0,a.sV)((()=>{s.log(l),o=(0,r.R9)(c.value,l.chartOptions),m(l),l.priceScaleOptions&&o.priceScale().applyOptions(l.priceScaleOptions),l.timeScaleOptions&&o.timeScale().applyOptions(l.timeScaleOptions),o.timeScale(),l.autosize&&window.addEventListener("resize",p)})),(0,a.hi)((()=>{o&&(o.remove(),o=null),n&&(n=null)})),(0,a.wB)((()=>l.autosize),(e=>{e?window.addEventListener("resize",p):window.removeEventListener("resize",p)})),(0,a.wB)((()=>l.type),(e=>{n&&o&&o.removeSeries(n),m(l)})),(0,a.wB)((()=>l.data),(e=>{n&&n.setData(e)})),(0,a.wB)((()=>l.chartOptions),(e=>{o&&o.applyOptions(e)})),(0,a.wB)((()=>l.seriesOptions),(e=>{n&&n.applyOptions(e)})),(0,a.wB)((()=>l.priceScaleOptions),(e=>{o&&o.priceScale().applyOptions(e)})),(0,a.wB)((()=>l.timeScaleOptions),(e=>{o&&o.timeScale().applyOptions(e)})),(e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"lw-chart",ref_key:"chartContainer",ref:c},null,512))}};var v=l(12807);const d=(0,v.A)(c,[["__scopeId","data-v-65d7e6ce"]]),p=d;var m=l(11333),g=l(59033),f=l(40702),y=l(79432),b=l(7711),k=l(7757),F=l(77474),_=l(81750),h=function(e,t,l,a){function i(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,u){function n(e){try{r(a.next(e))}catch(t){u(t)}}function o(e){try{r(a["throw"](e))}catch(t){u(t)}}function r(e){e.done?l(e.value):i(e.value).then(n,o)}r((a=a.apply(e,t||[])).next())}))};const w=e=>((0,a.Qi)("data-v-347a923d"),e=e(),(0,a.jt)(),e),x={class:"flex items-center no-wrap q-mb-md"},B=w((()=>(0,a.Lk)("br",null,null,-1))),L=w((()=>(0,a.Lk)("br",null,null,-1))),P={class:"text-grey-7 q-mb-sm"},q=w((()=>(0,a.Lk)("p",{class:"text-grey-7 q-mb-sm"},"Цена за единицу",-1))),O=w((()=>(0,a.Lk)("p",{class:"text-grey-7 q-mb-sm"},"Итого",-1))),A={class:"row q-col-gutter-sm"},C={class:"col-6"},S={class:"orders-grid"},W=w((()=>(0,a.Lk)("div",{class:"flex items-center justify-between"},[(0,a.Lk)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Цена"),(0,a.Lk)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Объем")],-1))),R={class:"no-margin price-red-color text-10 text-weight-medium"},K={class:"no-margin vol-color text-10 text-weight-medium"},Q={class:"col-6"},V={class:"orders-grid"},z=w((()=>(0,a.Lk)("div",{class:"flex items-center justify-between"},[(0,a.Lk)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Цена"),(0,a.Lk)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Объем")],-1))),j={class:"no-margin price-green-color text-10 text-weight-medium"},D={class:"no-margin vol-color text-10 text-weight-medium"},E={class:"col-6"},H={class:"flex items-center justify-between"},I=w((()=>(0,a.Lk)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Всего",-1))),T={class:"no-margin text-10 text-grey-8 text-weight-medium"},X={class:"col-6"},U={class:"flex items-center justify-between"},M=w((()=>(0,a.Lk)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Всего",-1))),Y={class:"no-margin text-10 text-grey-8 text-weight-medium"};var $;(function(e){e["Sell"]="sell",e["Buy"]="buy"})($||($={}));const G=(0,a.pM)({__name:"trade",setup(e){const{getOrdersByQuoteBase:t,tradePairVolumes:l,getTradeHistory:r}=(0,m.W)(),s=(0,m.W)(),c=(0,g.G)(),v=(0,o.lq)(),{createOrder:d,signTransaction:w}=(0,F.Z)(),G=(0,u.KR)(!1),N=(0,u.KR)(!1),Z=(0,u.KR)(null),J=v.params.b_key,ee=v.params.q_key,te=(0,u.KR)(),le=(0,u.KR)("area"),ae=(0,u.KR)({color:"rgb(45, 77, 205)"}),ie=(0,u.KR)([]),ue=(0,u.KR)([]),ne=(0,u.KR)([]),oe=(0,u.KR)($.Buy),re=(0,u.KR)(0),se=(0,u.KR)(0),ce=(0,u.KR)({amount:null,unitPrice:null,total:null}),ve=new Date,de=((0,a.EW)((()=>new Date(ve.getFullYear(),ve.getMonth(),ve.getDate()-ve.getDay()+1,0,0,0,0).getTime())),(0,a.EW)((()=>new Date(ve.getFullYear(),ve.getMonth(),1,0,0,0,0).getTime()))),pe=c.allAssets.find((e=>e.key===parseInt(J))),me=c.allAssets.find((e=>e.key===parseInt(ee))),ge=()=>h(this,void 0,void 0,(function*(){G.value=!G.value;const e=oe.value===$.Buy?me.key:pe.key,t=oe.value===$.Buy?ce.value.total:ce.value.amount,l=oe.value===$.Buy?pe.key:me.key,a=oe.value===$.Buy?ce.value.amount:ce.value.total,i=yield d(e,t,l,a);_.log(i),Z.value=i.raw||null,G.value=!G.value,Z.value&&(N.value=!0)}));(0,a.sV)((()=>h(this,void 0,void 0,(function*(){var e,l,a,i;yield t(ee,J),ie.value=yield r(J,ee,de.value),_.log(ie.value);for(let t of null===(e=s.ordersByQuoteBase)||void 0===e?void 0:e.have){re.value+=parseFloat(t.leftHave);let e=[];e=null===(l=s.ordersByQuoteBase)||void 0===l?void 0:l.have.filter((e=>e.pairPrice===t.pairPrice));let a=0;if(ue.value.filter((e=>e.pairPrice===t.pairPrice)).length>0);else{for(let t of e)a+=parseFloat(t.leftHave);e[0].leftHave=a,ue.value.push(e[0])}}for(let t of null===(a=s.ordersByQuoteBase)||void 0===a?void 0:a.want){se.value+=parseFloat(t.leftWant);let e=[];e=null===(i=s.ordersByQuoteBase)||void 0===i?void 0:i.want.filter((e=>e.pairPrice===t.pairPrice));let l=0;if(ne.value.filter((e=>e.pairPrice===t.pairPrice)).length>0);else{for(let t of e)l+=parseFloat(t.leftWant);e[0].leftWant=l,ne.value.push(e[0])}}}))));const fe=()=>{_.log("dd"),ce.value.amount||(ce.value.total=null,ce.value.unitPrice=null),ce.value.unitPrice&&(ce.value.total=parseFloat(ce.value.amount*ce.value.unitPrice).toFixed(5))};function ye(){ce.value.amount&&(ce.value.total=parseFloat(ce.value.amount*ce.value.unitPrice).toFixed(5))}function be(){ce.value.unitPrice&&(ce.value.amount=parseFloat(ce.value.total/ce.value.unitPrice).toFixed(5))}function ke(e){_.log(e),ce.value.amount=e.leftWant,ce.value.unitPrice=e.pairPrice,ce.value.total=parseFloat(e.leftWant*e.pairPrice).toFixed(5),oe.value=$.Sell}function Fe(e){ce.value.amount=parseFloat(e.leftHave).toFixed(5),ce.value.unitPrice=e.pairPrice,ce.value.total=parseFloat(e.leftHave*e.pairPrice).toFixed(5),oe.value=$.Buy}const _e=()=>h(this,void 0,void 0,(function*(){G.value=!G.value,yield w(Z.value),N.value=!1,G.value=!G.value}));return(e,t)=>{const l=(0,a.g2)("q-card-section"),o=(0,a.g2)("q-card"),r=(0,a.g2)("q-btn"),s=(0,a.g2)("q-form"),c=(0,a.g2)("q-linear-progress"),v=(0,a.g2)("q-separator"),d=(0,a.g2)("q-page"),m=(0,a.g2)("q-item-section"),g=(0,a.g2)("q-item"),F=(0,a.g2)("q-list"),_=(0,a.g2)("q-card-actions"),h=(0,a.g2)("q-dialog"),w=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(d,{padding:"",id:"page_wrapper"},{default:(0,a.k6)((()=>[(0,a.bF)(y.A,null,{default:(0,a.k6)((()=>[(0,a.bF)(f.A,{offset:32,target_element_id:"page_wrapper"},{default:(0,a.k6)((()=>[(0,a.bF)(o,{flat:"",bordered:"",class:"q-mb-sm bg-grey-invert"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"q-pa-sm"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{type:le.value,data:ie.value,autosize:!0,"series-options":ae.value,ref_key:"lwChart",ref:te},null,8,["type","data","series-options"])])),_:1})])),_:1}),(0,a.bF)(o,{flat:"",bordered:"",class:"q-mb-sm bg-grey-invert"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"q-pa-sm"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",x,[(0,a.bF)(r,{unelevated:"","no-caps":"",class:"bye-btn full-width q-py-sm",color:oe.value===$.Buy?"positive":"grey-5",onClick:t[0]||(t[0]=e=>oe.value=$.Buy)},{default:(0,a.k6)((()=>{var e,t;return[(0,a.eW)(" Купить "+(0,i.v_)(null===(e=(0,u.R1)(pe))||void 0===e?void 0:e.name)+" за",1),B,(0,a.eW)(" "+(0,i.v_)(null===(t=(0,u.R1)(me))||void 0===t?void 0:t.name),1)]})),_:1},8,["color"]),(0,a.bF)(r,{color:oe.value===$.Sell?"negative":"grey-5",unelevated:"",class:"sell-btn full-width q-py-sm","no-caps":"",onClick:t[1]||(t[1]=e=>oe.value=$.Sell)},{default:(0,a.k6)((()=>{var e,t;return[(0,a.eW)(" Продать "+(0,i.v_)(null===(e=(0,u.R1)(pe))||void 0===e?void 0:e.name)+" за",1),L,(0,a.eW)(" "+(0,i.v_)(null===(t=(0,u.R1)(me))||void 0===t?void 0:t.name),1)]})),_:1},8,["color"])]),(0,a.bF)(s,{onSubmit:(0,n.D$)(ge,["prevent"])},{default:(0,a.k6)((()=>[(0,a.Lk)("p",P,(0,i.v_)(oe.value===$.Buy?"Количество к покупке":"Количество к продаже"),1),(0,a.bF)(b.A,{modelValue:ce.value.amount,"onUpdate:modelValue":t[2]||(t[2]=e=>ce.value.amount=e),"margin-bottom":!1,type:"number",step:".00001",onKeyup:fe,clearable:"","lazy-rules":"",rules:[e=>e&&e.length>0&&0!==parseFloat(e)||"Это обязательное поле"]},null,8,["modelValue","rules"]),q,(0,a.bF)(b.A,{modelValue:ce.value.unitPrice,"onUpdate:modelValue":t[3]||(t[3]=e=>ce.value.unitPrice=e),"margin-bottom":!1,type:"number",step:".00001",onKeyup:ye,clearable:"","lazy-rules":"",rules:[e=>e&&e.length>0&&0!==parseFloat(e)||"Это обязательное поле"]},null,8,["modelValue","rules"]),O,(0,a.bF)(b.A,{modelValue:ce.value.total,"onUpdate:modelValue":t[4]||(t[4]=e=>ce.value.total=e),"margin-bottom":!1,type:"number",step:".00001",onKeyup:be,clearable:"","lazy-rules":"",rules:[e=>e&&e.length>0&&0!==parseFloat(e)||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,a.bF)(k.A,{loading:G.value,label:oe.value===$.Buy?"Купить":"Продать",color:oe.value===$.Buy?"positive":"negative",class:"full-width q-mb-md",unelevated:"",size:"18px","no-caps":"",type:"submit"},null,8,["loading","label","color"])])),_:1})])),_:1})])),_:1}),(0,a.bF)(o,{flat:"",bordered:"",lass:"bg-grey-invert"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"q-pa-sm"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",A,[(0,a.Lk)("div",C,[(0,a.Lk)("div",S,[W,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(ue.value.slice(0,15),((e,t)=>((0,a.uX)(),(0,a.Wv)(c,{reverse:"",onClick:t=>Fe(e),class:"flex items-center justify-between relative-position sell-pr",color:"red-2",value:e.leftHave/e.amountHave,size:"20px"},{default:(0,a.k6)((()=>[(0,a.Lk)("p",R,(0,i.v_)(e.pairPrice),1),(0,a.Lk)("p",K,(0,i.v_)(e.leftHave),1)])),_:2},1032,["onClick","value"])))),256))])]),(0,a.Lk)("div",Q,[(0,a.Lk)("div",V,[z,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(ne.value.slice(0,15),((e,t)=>((0,a.uX)(),(0,a.Wv)(c,{onClick:t=>ke(e),class:"flex items-center justify-between relative-position bg-white buy-pr",color:"light-green-11",value:e.leftWant/e.amountWant,size:"20px"},{default:(0,a.k6)((()=>[(0,a.Lk)("p",j,(0,i.v_)(e.pairPrice),1),(0,a.Lk)("p",D,(0,i.v_)(e.leftWant),1)])),_:2},1032,["onClick","value"])))),256))])]),(0,a.Lk)("div",E,[(0,a.bF)(v),(0,a.Lk)("div",H,[I,(0,a.Lk)("p",T,(0,i.v_)(re.value),1)])]),(0,a.Lk)("div",X,[(0,a.bF)(v),(0,a.Lk)("div",U,[M,(0,a.Lk)("p",Y,(0,i.v_)(se.value),1)])])])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(h,{modelValue:N.value,"onUpdate:modelValue":t[5]||(t[5]=e=>N.value=e),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)((()=>[(0,a.bF)(o,{style:{width:"100%"}},{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"bg-grey-invert"},{default:(0,a.k6)((()=>[(0,a.eW)(" Подтверждение транзакции создании ордера ")])),_:1}),(0,a.bF)(l,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{separator:"",dense:""},{default:(0,a.k6)((()=>[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)("Имею")])),_:1}),(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(oe.value===$.Buy?ce.value.total:ce.value.amount)+" "+(0,i.v_)(oe.value===$.Buy?(0,u.R1)(me).name:(0,u.R1)(pe).name),1)])),_:1})])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)("Хочу")])),_:1}),(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(oe.value===$.Buy?ce.value.amount:ce.value.total)+" "+(0,i.v_)(oe.value===$.Buy?(0,u.R1)(pe).name:(0,u.R1)(me).name),1)])),_:1})])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)("Комиссия сети")])),_:1}),(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)(" 0.000149 OLF ")])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(_,{align:"right"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.bF)(r,{"no-caps":"",unelevated:"",color:"grey-6",loading:G.value,label:"Отмена"},null,8,["loading"]),[[w]]),(0,a.bF)(r,{"no-caps":"",unelevated:"",loading:G.value,onClick:_e,label:oe.value===$.Buy?"Купить":"Продать",color:oe.value===$.Buy?"positive":"negative"},null,8,["loading","label","color"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}});var N=l(33177),Z=l(97569),J=l(27066),ee=l(69001),te=l(21565),le=l(42876),ae=l(37015),ie=l(57201),ue=l(54514),ne=l(75329),oe=l(63418),re=l(16334),se=l(62769),ce=l(98582),ve=l.n(ce);const de=(0,v.A)(G,[["__scopeId","data-v-347a923d"]]),pe=de;ve()(G,"components",{QPage:N.A,QCard:Z.A,QCardSection:J.A,QBtn:ee.A,QForm:te.A,QLinearProgress:le.A,QSeparator:ae.A,QDialog:ie.A,QList:ue.A,QItem:ne.A,QItemSection:oe.A,QCardActions:re.A}),ve()(G,"directives",{ClosePopup:se.A})}}]);